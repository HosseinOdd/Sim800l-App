name: Buildname: Build



on:on:

  push:  push:

    branches: [ main, master, develop ]    branches: [ main, master, develop ]

  pull_request:  pull_request:

    branches: [ main, master, develop ]    branches: [ main, master, develop ]



jobs:jobs:

  build-and-test:  build:

    runs-on: ${{ matrix.os }}    runs-on: ${{ matrix.os }}

    strategy:    strategy:

      fail-fast: false      matrix:

      matrix:        os: [ubuntu-latest, windows-latest, macos-latest]

        os: [ubuntu-latest, windows-latest, macos-latest]        

            steps:

    steps:    - name: Checkout code

    - name: Checkout      uses: actions/checkout@v4

      uses: actions/checkout@v4      

          - name: Set up JDK 17

    - name: Set up JDK 17      uses: actions/setup-java@v4

      uses: actions/setup-java@v4      with:

      with:        distribution: 'temurin'

        distribution: 'temurin'        java-version: '17'

        java-version: '17'        cache: 'maven'

        cache: 'maven'        

            - name: Build with Maven

    - name: Build with Maven      run: mvn clean package -DskipTests

      run: mvn clean package -DskipTests      

          - name: Run tests

    - name: Run tests (if any)      run: mvn test

      run: mvn test || true      

      continue-on-error: true    - name: Upload JAR artifact

            uses: actions/upload-artifact@v4

    - name: Check JAR exists      with:

      shell: bash        name: jar-${{ matrix.os }}

      run: |        path: target/SIM800LManager-v2.0.jar

        if [ -f target/SIM800LManager-v2.0.jar ]; then
          echo "✅ JAR built successfully"
          ls -lh target/SIM800LManager-v2.0.jar
        else
          echo "❌ JAR not found"
          exit 1
        fi
        
    - name: Upload artifact
      uses: actions/upload-artifact@v4
      with:
        name: jar-${{ matrix.os }}
        path: target/SIM800LManager-v2.0.jar
        retention-days: 7
